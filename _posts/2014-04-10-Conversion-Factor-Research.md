---
layout: post
title: 国债期货转换因子的计算及性质研究
tags: [金融, 债券, 国债, 衍生品, 期货, 国债期货, R]

---

国债期货的转换因子（Conversion
Factor，简写“CF”）由中国金融期货交易所（以下简称“中金所”）在期货合约上市时公布且不再变化，在合约存续期间如果有新的可交割债券上市，则中金所将会在新债上市时公布其对应各个合约的转换因子。尽管如此，了解转换因子的计算原理和方法对于理解国债期货的定价等方面仍有很大帮助，同时在新债招标和上市前，通过提前计算转换因子来得到隐含回报率（IRR）并预测国债期货的走势和套利空间。

本文旨在简要探讨转换因子的计算方法，并一步步分析其在 R 语言中的实现方式。

转换因子的概念
==============

转换因子的作用
--------------

国债期货重启后的最大特点，也是区别于因“327”事件被叫停的国债期货的基本特征是采用了虚拟标的券，而非原来的个券标的券。这样的好处在于大大增加了可交割券，防止类似“327”事件中的逼空等扰乱市场秩序的情况。目前的国债期货合约采用了是票面利率为 3% 的虚拟 5
年期国债，理论上来说在国债期货合约到期月份首日剩余期限为 4 ～ 7 年的国债均可用作交割[^1]。为保证所有可用于交割国债在交割时能够以公平价格进行交割，因此需要用转换因子将不同到期日、不同票面利率、不同付息频率的国债进行统一转换，即为每只可交割券确定对应不同合约的转换因子。
有了转换因子之后，国债期货的交割就可以进行了，根据《交割细则》，
$\text{交割货款} = \text{交割数量} \times \text{发票价格} \times \text{（合约面值} / 100\text{元）}$
。其中，
$\text{发票价格} = \text{交割结算价} \times \text{转换因子} + \text{应计利息}$
。前面的公式中，除转换因子之外的要素都是已知的，因此需要给定转换因子才能完成交割。正是由于交割结算需要用到转换因子，因此大量的国债期货策略也就都必须考虑到转换因子的因素。

转换因子的原理
--------------

根据前面提到的，转换因子是将在合约到期月份首日时剩余期限在 4 ～ 7 年的可交割券的未来现金流按照 3% 的贴现率贴现到该日，由于国债期货虚拟标准券的票面利率就是 3%，因此其贴现结果为 100元，而其他债券贴现结果与 100元的比率就是转换因子。需要注意的是，贴现到这一天的结果是一个全价，而国债期货的报价为净价，因此得到贴现值还应当减去至贴现日的应计利息。
由上述分析，我们可以得到转换因子计算的基本原理是将其分解为两项，第一项是将被计算债券的未来现金流按照 3% 贴现至合约到期月份首日，第二项是减去该只债券在该日的应计利息，最后，如果计算时采用百元为单位则除以 100 来转化为 1 元债券对应的转换比率，即为转换因子。
转换因子应在 1 附近，因为一般而言可交割债券的票面利率不会较 3% 有太大偏差。而且，理论上可以很容易分析出来，可交割券票面利率大于 3% 则转换因子大于 1 ，反之则小于 1。
具体公式如下：

$$CF = \frac{\frac{c}{f}}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td}}} + \frac{\frac{c}{f}}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td} + 1}} + \ldots + \frac{\frac{c}{f} + 1}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td} + n - 1}} - \frac{c}{f} \times \frac{td - d}{td} \label{eq: cfbasic}$$

其中：

-   $CF$ 表示转换因子；

-   $c$ 意即 coupon，表示票面利息；

-   $f$ 意即 frequency，表示一年中的付息频率，目前国内一般为 1 或者 2；

-   $r$ 意即 discount
    rate，表示贴现率，在国债期货中为虚拟券票面利率 3%；

-   $n$ 表示剩余付息次数；

-   $d$ 意即 days，表示自合约到期月份首日至下一付息日的剩余天数；

-   $td$ 意即 total days，表示当前付息周期内的总天数[^2]。

转换因子的计算方法
==================

转换因子的计算方法并不困难，按照上述的计算原理一步步运算即可。在实际操作的过程中，可以有两种方式来实现：一种是直接构造现金流，然后乘以对应的折现因子，再减去应计利息，如公式 [eq:
cfbasic] 所示；另一种是将公式进行推导简化后直接计算公式。本质上来说，两者没有太大区别，但是在实践中，中金所确实提供了计算公式，但该计算公式采用了月度取整的方式，没有精确到天，这使得其提供的转换因子并不是特别精确[^3]。但由于中金所公布的转换因子用于计算交割价格，因此其具有权威性，也对各种策略产生影响，因此还是要了解其计算方法的问题所在。

转换因子的计算公式
------------------

在公式 [eq:
cfbasic] 中已经给出了转换因子的基本公式，仔细观察该公式就可以发现，虽然该公式可以直接进行计算，但是由于其包含了一个等比序列，完全可以用等比序列求和的方式进行简化，从而得到易于计算的简化版公式。
计算过程如下：

$$\begin{aligned}
CF &= \frac{\frac{c}{f}}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td}}} + \frac{\frac{c}{f}}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td} + 1}} + \ldots + \frac{\frac{c}{f} + 1}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td} + n - 1}} - \frac{c}{f} \times \frac{td - d}{td} \notag \\
   &= \frac{1}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td}}} \left( \frac{c}{f} + \frac{\frac{c}{f}}{\left( 1 + \frac{r}{f} \right)^1} + \ldots + \frac{\frac{c}{f}}{\left(1 + \frac{r}{f}\right)^{n - 1}} + \frac{1}{\left(1 + \frac{r}{f}\right)^{n - 1}} \right) \notag \\
   & \quad - \frac{c}{f} \times \frac{td - d}{td} \notag \\
   &= \frac{1}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td}}} \left( \frac{c}{f} + \frac{c}{r} \left( 1 - \frac{1}{\left( 1 + \frac{r}{f} \right)^{n - 1}} \right) + \frac{1}{\left(1 + \frac{r}{f}\right)^{n - 1}} \right) - \frac{c}{f} \times \frac{td - d}{td} \notag \\
CF &= \frac{1}{\left(1 + \frac{r}{f}\right)^{\frac{d}{td}}} \left( \frac{c}{f} + \frac{c}{r} + \left( 1 - \frac{c}{r} \right) \times \frac{1}{\left( 1 + \frac{r}{f} \right)^{n - 1}} \right) - \frac{c}{f} \times \left( 1 - \frac{d}{td} \right) \label{eq: cfsimple}\end{aligned}$$

经过推导得到的公式 [eq:
cfsimple] 已经不再包含不确定的项，只要将公式中的参数确定，即可得到转换因子 $CF$，而公式中的参数都可以很容易知道确定的值。此外，我们再看一下中金所正式公布[^4]的转换因子计算公式：

$$CF = \frac{1}{\left(1 + \frac{r}{f}\right)^{\frac{xf}{12}}} \left[ \frac{c}{f} + \frac{c}{r} + \left( 1 - \frac{c}{r} \right) \times \frac{1}{\left( 1 + \frac{r}{f} \right)^{n - 1}} \right] - \frac{c}{f} \times \left( 1 - \frac{xf}{12} \right) \label{eq: cfcfe}$$

经过推导得到的公式 [eq: cfsimple] 与中金所正式发布的公式 [eq:
cfcfe] 从外形来看极其相似，可以说是基本一致的，事实上中金所公布的公式只是个结果公式，即任何人都可以按照这个公式来计算得到转换因子，但公式本身的形式完全无法解释，因为它是一个推导结果。两个公式的唯一不同之处就在于 $d / td$ 和 $xf / 12$ 这一处，也就是前面提到的，中金所将当前付息周期剩余期限精确到月，而本文推导的公式精确到天。其中，$x$ 为交割月到下一付息月的月份数，而 $f$ 同样表示一年中的付息频率，因此分数 $xf / 12$ 就可以表示贴现日相对于下一个付息日的精确到月的剩余期限。再次强调的是，中金所的公式仅供计算来用，无法直观去解释。

转换因子的计算要素 {#sec: factors}
------------------

转换因子的计算要素其实就是指上述公式当中所涉及的相关要素，部分是债券本身的要素，部分是根据实际需要而进行计算得来的。实际上，在公式已经明确的前提下，只要将要素的内容和获取方式弄清楚，也就可以直接计算得到转换因子了。

-   票面利息（参数 $c$），是指要计算的债券单位乘以票面利率，例如票面利率为 3.5% 而债券单位为 1 
    元，则 $c$ 为 $1 \times 3.5\% = 0.035 \text{元}$。需要明确的是，转换因子的基础公式应当为公式 [eq:
    cfbasic]，该公式的原理就是将 1 
    元的债券进行贴现，所以分子和整个公式的单位是“元”，至于是乘以 1 元还是乘以 100 元，取决于公式中贴现本金的一项中是贴现 1 元还是 100 元，公式 [eq:
    cfbasic] 中为贴现 1 元，这是由于贴现因子最终表现形式为一个 1 附近的数字；

-   付息频率（参数 $f$），是指债券在一个自然年中支付利息的次数，在美国基本都为一年付息 2 次，而中国的记账式固定利率附息国债中，期限低于 10 年的按年度付息，10 年及以上的期限品种按半年付息。按目前的实际情况看，参数 $f$ 只能取值 1 或者 2；

-   贴现率（参数 $r$），前面已经提到只能取值 3%；

-   剩余付息次数（参数 $n$），字面来看很容易理解，在计算过程中只要按照起息日、到期日和付息频率生成一个付息日的序列，取其中大于合约到期月份首日（“贴现日”）的日期并计算个数即可；

-   当前付息周期内的剩余天数（参数 $d$），在前面得到付息日序列时，其中最近的日期即为下一付息日，用这一日期减去贴现日即可得到参数 $d$ 的值，需要说明的是，中国债券市场的计息方式是就“算头不算尾”，而日期在计算机系统中的记录方式一般是一个整数，因此两个日期相减得到就是两个日期间“算头不算尾”的计息天数。

-   当前付息周期的总天数（参数 $td$），其计算方法与计算剩余天数是一样的，只不过是用下一付息日减去前一付息日，这样可以得到精确的天数，因为一年的天数可以为 365 天或 366 天，而半年的天数可以为 180 天到 184 天不等；

-   交割月到下一付息月的月份数（参数 $x$），这是在计算中金所的不精确公式时使用的参数，实际上计算起来也不困难，首先确定合约到期月份，为 3、6、9 或 12，然后再确认下一付息日所在月份，后者减去前者即为结果，如果结果为负数则加上 12 为正确结果，需要提及一下的是，该结果不太可能为 0，这是由于根据中金所关于可交割券的规定和财政部、中央国债公司关于国债转托管的管理规定来看，付息日在交割月份的债券由于转托管的限制而不太可能成为可交割券，目前三个合约的可交割券中还没有付息日在交割月份的情况出现[^5]。

### 转换因子的计算结果及对比

在分析了计算转换因子的公式和要素之后就可以对其进行计算，并对比剩余期限精确度对实际计算得到的转换因子的影响；同时还可以对比中金所发布的转换因子，观察经过上述分析后利用这些要素作为参数带入其公布的公式中能否得到一致的结果。
表 [tab:
tf1312cf] 中列示了合约 TF1312 可交割券的转换因子计算结果。此处仅以该合约做例说明，另外两个合约的数据在附录中给出。

<span>@lrrrrr</span>\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
 050012.IB & 1.0403 & 1.0403 & 0 & 1.0405 & 0.0002\
080003.IB & 1.0424 & 1.0424 & 0 & 1.0428 & 0.0004\
080018.IB & 1.0299 & 1.0299 & 0 & 1.0302 & 0.0003\
090003.IB & 1.0024 & 1.0024 & 0 & 1.0024 & 0.0000\
090007.IB & 1.0010 & 1.0010 & 0 & 1.0010 & 0.0000\
090016.IB & 1.0245 & 1.0245 & 0 & 1.0247 & 0.0002\
090023.IB & 1.0230 & 1.0230 & 0 & 1.0232 & 0.0002\
090027.IB & 1.0366 & 1.0366 & 0 & 1.0367 & 0.0001\
100002.IB & 1.0240 & 1.0240 & 0 & 1.0241 & 0.0001\
100007.IB & 1.0203 & 1.0203 & 0 & 1.0205 & 0.0002\
100012.IB & 1.0145 & 1.0145 & 0 & 1.0146 & 0.0001\
100024.IB & 1.0168 & 1.0168 & 0 & 1.0168 & 0.0000\
100031.IB & 1.0176 & 1.0176 & 0 & 1.0177 & 0.0001\
100034.IB & 1.0411 & 1.0411 & 0 & 1.0415 & 0.0004\
110003.IB & 1.0314 & 1.0314 & 0 & 1.0319 & 0.0005\
110006.IB & 1.0294 & 1.0294 & 0 & 1.0294 & 0.0000\
110017.IB & 1.0294 & 1.0294 & 0 & 1.0295 & 0.0001\
110021.IB & 1.0288 & 1.0288 & 0 & 1.0290 & 0.0002\
120005.IB & 1.0196 & 1.0196 & 0 & 1.0196 & 0.0000\
120010.IB & 1.0069 & 1.0069 & 0 & 1.0069 & 0.0000\
120016.IB & 1.0129 & 1.0129 & 0 & 1.0130 & 0.0001\
130001.IB & 1.0056 & 1.0056 & 0 & 1.0057 & 0.0001\
130003.IB & 1.0230 & 1.0230 & 0 & 1.0232 & 0.0002\
130008.IB & 1.0164 & 1.0164 & 0 & 1.0165 & 0.0001\
130013.IB & 1.0036 & 1.0036 & 0 & 1.0036 & 0.0000\
130015.IB & 1.0270 & 1.0270 & 0 & 1.0271 & 0.0001\
130020.IB & 1.0651 & 1.0651 & 0 & 1.0655 & 0.0004\
130023.IB & 1.0509 & 1.0509 & 0 & 1.0511 & 0.0002\

表 [tab: tf1312cf] 中“CF（公式 [eq:
cfcfe]）”一列是指用前面提到的中金所给出的公式计算的转换因子，后面的“对比”一列是计算的结果与中金所实际给出的转换因子的差，非常明显，这一列的结果全部为“0”，两列数字完全一一对应相等，这说明前面在计算要素部分的分析和处理在计算结果来看都是正确的，也就是说中金所也是这样处理的，特别是关于剩余月份的处理。

表 [tab: tf1312cf] 中“CF（公式 [eq:
cfsimple]）”一列是用前面推导的公式进行计算的，其中剩余期限精确到“天”，可以看到后面“对比”列中基本都不为“0”，而是略微大于“0”，本例中其幅度在 0 到 0.0005 之间。对此，我们可以做简单的分析，精确到天的剩余期限大于精确到月的剩余期限[^6]，观察公式 [eq:
cfsimple] 和公式 [eq:
cfcfe] 可以看出，这样的影响一处是在贴现项的分母，另一处是在应计利息。因此，尽管精确的剩余期限使得分母变大，但显然使得应计利息项变小的影响更大，而这种影响应当是动态的，临界点就是贴现率 3%，因此合约 TF1403 的可交割券中“080025.IB”便是票面利率低于 3% 的，其转换因子小于 1 同时精确计算的转换因子也比中金所的要小。

最后，表 [tab:
ttest] 中给出了根据三个合约可交割券用两种方法计算的转换因子之差的 $t-\text{检验}$数据，此处以该差值为样本，检验其均值是否显著为“0”，如果显著则说明两种方法得到的结果在统计意义上是不存在差异的，反之则说明从统计意义来讲二者存在差异。从结果数据中可以看到，$p-\text{value}$ 都很小，因此应当拒绝样本均值为 0 的原假设，接受均值不为 0 的备择假设。结论是，两种方法得到转换因子虽然存在的差异很小，但是统计意义上二者的差异是显著的，不应当被忽略掉。

<span>@lccc</span>\
合约代码 & 均值 & $t-\text{统计量}$ & $p-\text{值}$\
\
合约代码 & 均值 & $t-\text{统计量}$ & $p-\text{值}$\
 TF1312.CFE & $1.54 \times 10^{-4}$ & 5.802 & $3.57 \times 10^{-6}$\
TF1403.CFE & $1.75 \times 10^{-4}$ & 4.473 & $1.73 \times 10^{-4}$\
TF1406.CFE & $1.67 \times 10^{-4}$ & 7.230 & $2.33 \times 10^{-7}$\

关于精确问题的小议 {#sec: precision}
------------------

前面多次提到了“精确”一词，其意义在于指出中金所采用了一种国外[^7]的惯例处理方式，即将剩余期限精确到“月”，而本文在探讨转换因子计算的方法时直接精确到“天”。但这样的精确还是不够的，原因在于以合约到期月份首日计只是合约赋予期货买卖方从该月首日开始可以进行交割的权利，而从转换因子的理论来看应当贴现到实际交割日，按照中金所的规定就是“配对缴款日”，因为计息是到这一天为止。因此，“真正”的转换因子应该不是一个，而是多个，具体而言就是从合约到期月份首个交易日后的第二个交易日[^8]到最后交易日后的第二个交易日，应以这个区间内的每一个交易日为贴现日计算转换因子序列。

转换因子主要性质简述
====================

根据前面计算的转换因子结果，我们简单归纳一下转换因子的一些性质，下图可以简要描述合约 TF1312 的一些情况：

![image](figure/relation_cf)

从图[fig:relation~c~f]中，可以看出转换因子与债券主要的几项要素之间的关系，图中以颜色的深浅表示期限的变化，以图形的形状表示付息频率。从中我们看出其具有以下的一些特性：

-   转换因子和票面利率存在着一定的线性关系，从图中可以看到各个点的分布反映出二者间存在一定的正相关关系，而且随着利率的变大，点的位置更加发散，即线性关系减弱，图中清晰地显示，以 3.6% 为界，小于该值的点多数都在 95% 的置信区间内，而大于的点则多数在区间外，这是由于贴现计算中利率越大贴现结果变化越大（敏感性越强），而后面的减去应计利息项的变化也更大；

-   在利率大体相近的情况下，期限越长的债券其转换因子也更大，图中可以较为明显地看到，在纵向方向的比较中，越靠上的点的颜色越浅，即期限越长，这是由于期限长则就久期长从而敏感性强带来的影响；

-   付息频率大则转换因子大，这也可以从久期的概念来理解，但是从实践中可以看到这种趋势，但是并不明显，这是由于两次付息相较于一次付息带来的久期变化不是特别明显，不过图中的确在很多纵向位置上，付息两次的债券都在付息一次的债券位置之上，当然也存在例外的情况，可以看到例外都是由于付息一次的债券期限更长，即颜色明显浅于同票面利率而付息两次的债券；

-   最后，从该图中还可以看到，合约 TF1312 的可交割券中不存在利率低于 3%的情况，所以其转换因子也全部大于 1。

R 语言实现
==========

本文使用 R 语言实现转换因子的计算和数据统计工作，其中数据获取通过 WindR 来完成，WindR 基本可以完整提供交易所的国债期货和现货的各项基础数据。

主要思路
--------

本文计算转换因子主要采用公式计算，即使用公式 [eq: cfsimple] 和公式 [eq:
cfcfe] ，这是由于这两个公式都是经过推导简化后的公式，只要输入相关参数就可以较为方便地计算得到转换因子；而另一种方式就是通过构建债券的现金流，之后对现金流进行贴现，最后减去应计利息，如公式 [eq:
cfbasic] 所示那样，这种方法略有不方便之处是要根据债券不同情况来构造其未来现金流并进行贴现计算，虽然在理解上更为直观，但计算起来其便捷程度不如前一种方法。

选择了使用推导公式计算之后，其基本思路就是构造一个包含了某一个或多个合约的债券及相关要素的二维数据框（`data.frame`），通过增加相应列的方式增加所需要参与计算的变量，在获得所有变量及其值之后计算转换因子。即通过由“债券要素”到“计算要素”再到“转换因子”的计算过程，来构造计算程序。

上述三个过程可以由对应的函数或多个函数来完成，本文构造了大体对应但不是绝对对应的函数来完成计算过程。

函数构建
--------

本文所构造的函数[^9]的思路是，首先构造一个“大”函数，其中包括对数据的获取，计算要素（变量）值并最终计算得到转换因子，输出的结果为一个包含了债券代码及其对应转换因子和其他要素的数据框[^10]。

其中，计算要素的环节由单独的函数完成，这也是由于需要计算的主要内容是各种期限相关的要素，可以一并处理；而计算转换因子的环节也由单独的函数完成，这一步骤中函数的主要作用就是提供计算公式完成计算，当然由于有两个精确度的计算公式，因此该函数应可以设置参数完成不同的计算。

### 计算要素函数

关于计算要素函数的功能前面已经提到，此处就个别计算方法问题稍作说明。实际上此处所说的计算要素就是要得到 [sec:
factors] 小节讨论过的这些要素。对于一个已知的可交割券而言，首先要明确的几个关键点就是其当前所处付息周期的前一个付息日、下一个付息日和剩余付息日，无论是使用本文采用的推导公式法计算还是采用构造现金流的方法来计算，这些要素都是所必须的。

根据债券的基本理论，我们可以构造一个以起息日（`carry`）为首项、以到期日（`maturity`）为末项、以付息周期为步进[^11]（`step`）的付息日序列（`coupond_seq`）；如果指定了贴现日（`discountday`），即本例中的合约到期月份首日，则付息日序列中贴现日之前最近的日期就是当前付息周期的前一付息日（理解为周期的起始日，设为 `start`），而对应的付息日序列中贴现日之后的最近日期就是当前付息周期的下一付息日（`end`）。在上述关系理清并计算得到相应的要素值之后，以日为单位的剩余期限计算就可以通过日期加减法来计算了。本段涉及的代码如下：

`     `\
`     `\
`  `\
`    `\
`    `

如果是精确到月份的情况，则其计算方法在 [sec:
factors] 小节介绍得很清楚了，其实计算原理和天的计算原理是一致的，只不过是针对月份而已，另外需要考虑日期对应计算机系统内部的某一整数，可以直接加减，月份加减当得到负数时加上 12 即为正确结果，代码如下：

`     `<span>“`%m`”</span>\
`     `<span>“`%m`”</span>\
`   `<span>`discountmonth) {`</span>\
`          `\
`  `<span>`{`</span>\
`        `\

### 转换因子计算函数

实际上，在获得了各种公式总的要素的前提下，转换因子的计算函数十分简单，基本上只是四则运算即可。本文根据公式的形式，将其分级为三项并分别计算，再计算最终结果。其中，当前付息周期的剩余期限一项（`frac`）是公式的关键，根据是否采用中金所（`CFE`）的算法应加以区别：

`           `

此外，在计算的最后应注意转换因子为四位小数，需要做四舍五入处理。

其它说明
--------

本文的函数构造还相对粗旷，很多还有待改进，例如在数据输入方面，本文的“大”函数包含了完整的数据输入部分，也可以通过将数据输入分离的改进来使得数据输入更为灵活，而仅保留数据验证部分。

此外，由于前述的这个问题，本文构造的函数仅用于输出单个合约的转换因子数据框，也可以在数据输入功能分离的基础上实现直接输出包含多个合约的数据框，其中仅需加入表示合约变量即可。

进一步扩展，这些函数既可以计算真实可交割券的转换因子，也可以计算虚拟债券的转换因子来加强对转换因子性质的研究。

最后补充一点的是，其实上述方法不算困难，在弄清楚计算方法的基础上本文采用的 R 语言只是个计算工具，使用 EXCEL 也同样可以完成转换因子的计算。

转换因子列表
============

<span>@lrrrrr</span>\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
 050012.IB & 1.0390 & 1.0390 & 0 & 1.0392 & 0.0002\
080010.IB & 1.0558 & 1.0558 & 0 & 1.0566 & 0.0008\
080025.IB & 0.9956 & 0.9956 & 0 & 0.9955 & -0.0001\
090007.IB & 1.0009 & 1.0009 & 0 & 1.0009 & 0.0000\
090012.IB & 1.0043 & 1.0043 & 0 & 1.0044 & 0.0001\
090016.IB & 1.0235 & 1.0235 & 0 & 1.0237 & 0.0002\
090027.IB & 1.0352 & 1.0352 & 0 & 1.0352 & 0.0000\
100002.IB & 1.0231 & 1.0231 & 0 & 1.0232 & 0.0001\
100012.IB & 1.0140 & 1.0140 & 0 & 1.0140 & 0.0000\
100019.IB & 1.0232 & 1.0232 & 0 & 1.0234 & 0.0002\
100024.IB & 1.0162 & 1.0162 & 0 & 1.0163 & 0.0001\
100034.IB & 1.0397 & 1.0397 & 0 & 1.0401 & 0.0004\
100041.IB & 1.0467 & 1.0467 & 0 & 1.0470 & 0.0003\
110002.IB & 1.0577 & 1.0577 & 0 & 1.0581 & 0.0004\
110017.IB & 1.0279 & 1.0279 & 0 & 1.0280 & 0.0001\
110021.IB & 1.0273 & 1.0273 & 0 & 1.0275 & 0.0002\
120010.IB & 1.0066 & 1.0066 & 0 & 1.0066 & 0.0000\
120016.IB & 1.0124 & 1.0124 & 0 & 1.0124 & 0.0000\
130003.IB & 1.0221 & 1.0221 & 0 & 1.0224 & 0.0003\
130008.IB & 1.0159 & 1.0159 & 0 & 1.0160 & 0.0001\
130013.IB & 1.0034 & 1.0034 & 0 & 1.0035 & 0.0001\
130015.IB & 1.0261 & 1.0261 & 0 & 1.0262 & 0.0001\
130020.IB & 1.0629 & 1.0629 & 0 & 1.0633 & 0.0004\
130023.IB & 1.0484 & 1.0484 & 0 & 1.0486 & 0.0002\

<span>@lrrrrr</span>\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
 050012.IB & 1.0377 & 1.0377 & 0 & 1.0379 & 0.0002\
080018.IB & 1.0269 & 1.0269 & 0 & 1.0273 & 0.0004\
090003.IB & 1.0022 & 1.0022 & 0 & 1.0022 & 0.0000\
090007.IB & 1.0009 & 1.0009 & 0 & 1.0009 & 0.0000\
090016.IB & 1.0225 & 1.0225 & 0 & 1.0227 & 0.0002\
090023.IB & 1.0212 & 1.0212 & 0 & 1.0214 & 0.0002\
090027.IB & 1.0337 & 1.0337 & 0 & 1.0338 & 0.0001\
100002.IB & 1.0222 & 1.0222 & 0 & 1.0223 & 0.0001\
100007.IB & 1.0189 & 1.0189 & 0 & 1.0191 & 0.0002\
100012.IB & 1.0134 & 1.0134 & 0 & 1.0135 & 0.0001\
100024.IB & 1.0156 & 1.0156 & 0 & 1.0157 & 0.0001\
100031.IB & 1.0164 & 1.0164 & 0 & 1.0165 & 0.0001\
100034.IB & 1.0384 & 1.0384 & 0 & 1.0388 & 0.0004\
110002.IB & 1.0558 & 1.0558 & 0 & 1.0561 & 0.0003\
110008.IB & 1.0503 & 1.0503 & 0 & 1.0506 & 0.0003\
110017.IB & 1.0265 & 1.0265 & 0 & 1.0266 & 0.0001\
110021.IB & 1.0259 & 1.0259 & 0 & 1.0261 & 0.0002\
120005.IB & 1.0178 & 1.0178 & 0 & 1.0179 & 0.0001\
120016.IB & 1.0119 & 1.0119 & 0 & 1.0119 & 0.0000\
130003.IB & 1.0212 & 1.0212 & 0 & 1.0214 & 0.0002\
130008.IB & 1.0152 & 1.0152 & 0 & 1.0154 & 0.0002\
130015.IB & 1.0252 & 1.0252 & 0 & 1.0253 & 0.0001\
130020.IB & 1.0608 & 1.0608 & 0 & 1.0611 & 0.0003\
130023.IB & 1.0460 & 1.0460 & 0 & 1.0461 & 0.0001\

<span>@lrrrrr</span>\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
\
债券代码&中金所 CF&CF（公式 [eq: cfcfe]）&对比&CF（公式 [eq:
cfsimple]）&对比\
 050012.IB & 1.0363 & 1.0363 & 0 & 1.0365 & 0.0002\
080025.IB & 0.9960 & 0.9960 & 0 & 0.9960 & 0.0000\
090007.IB & 1.0008 & 1.0008 & 0 & 1.0008 & 0.0000\
090012.IB & 1.0039 & 1.0039 & 0 & 1.0040 & 0.0001\
090016.IB & 1.0214 & 1.0214 & 0 & 1.0217 & 0.0003\
090027.IB & 1.0323 & 1.0323 & 0 & 1.0323 & 0.0000\
100002.IB & 1.0213 & 1.0213 & 0 & 1.0214 & 0.0001\
100012.IB & 1.0129 & 1.0129 & 0 & 1.0130 & 0.0001\
100019.IB & 1.0215 & 1.0215 & 0 & 1.0217 & 0.0002\
100024.IB & 1.0151 & 1.0151 & 0 & 1.0151 & 0.0000\
100034.IB & 1.0370 & 1.0370 & 0 & 1.0374 & 0.0004\
100041.IB & 1.0436 & 1.0436 & 0 & 1.0438 & 0.0002\
110002.IB & 1.0538 & 1.0538 & 0 & 1.0542 & 0.0004\
110015.IB & 1.0601 & 1.0601 & 0 & 1.0604 & 0.0003\
110019.IB & 1.0577 & 1.0577 & 0 & 1.0580 & 0.0003\
110021.IB & 1.0246 & 1.0246 & 0 & 1.0248 & 0.0002\
120005.IB & 1.0169 & 1.0169 & 0 & 1.0169 & 0.0000\
120010.IB & 1.0060 & 1.0060 & 0 & 1.0060 & 0.0000\
130003.IB & 1.0203 & 1.0203 & 0 & 1.0205 & 0.0002\
130008.IB & 1.0146 & 1.0146 & 0 & 1.0147 & 0.0001\
130015.IB & 1.0242 & 1.0242 & 0 & 1.0243 & 0.0001\
130020.IB & 1.0587 & 1.0587 & 0 & 1.0590 & 0.0003\
130023.IB & 1.0436 & 1.0436 & 0 & 1.0437 & 0.0001\

可交割券筛选及转换因子计算
==========================

下表中给出了 2013 年 12 月 12 日进行筛选的合约 TF1409 可交割券[^12]，并计算其转换因子，其筛选标准参考中金所的合约规则以及本文的前面的讨论内容，并根据这样的标准构造了专门用于筛选可交割券的函数，筛选的结果可以直接调用其他函数计算转换因子。经过筛选后的 TF1409 合约共有 23 只。需要指出的是，该函数需要加入手工剔除的个券，以合约 TF1409 为例，通过 WindR 提取数据中包含了具有银行间代码但实际上只能在上交所和深交所交易流通的 010007 国债，类似情况则需要手工剔除，不过这种情况一般只存在于部分“老券”，当前的国债发行工作相对稳定，记账式附息国债几乎全部为跨三个交易场所发行并交易流通。

<span>@lrrrrr</span>\
债券代码 & 剩余期限 & 票面 & 付息频率 & CF（中金所） & CF（精确）\
\
债券代码 & 剩余期限 & 票面 & 付息频率 & CF（中金所） & CF（精确）\
 050012.IB & 6.21 & 3.65 & 2 & 1.0363 & 1.0365\
080025.IB & 4.29 & 2.90 & 2 & 0.9960 & 0.9960\
090007.IB & 4.68 & 3.02 & 2 & 1.0008 & 1.0008\
090012.IB & 4.80 & 3.09 & 2 & 1.0039 & 1.0040\
090016.IB & 4.89 & 3.48 & 2 & 1.0214 & 1.0217\
090027.IB & 5.18 & 3.68 & 2 & 1.0323 & 1.0323\
100002.IB & 5.43 & 3.43 & 2 & 1.0213 & 1.0214\
100012.IB & 5.70 & 3.25 & 2 & 1.0129 & 1.0130\
100019.IB & 5.82 & 3.41 & 2 & 1.0215 & 1.0217\
100024.IB & 5.93 & 3.28 & 2 & 1.0151 & 1.0151\
100034.IB & 6.16 & 3.67 & 2 & 1.0370 & 1.0374\
100041.IB & 6.30 & 3.77 & 2 & 1.0436 & 1.0438\
110002.IB & 6.39 & 3.94 & 2 & 1.0538 & 1.0542\
110015.IB & 6.79 & 3.99 & 2 & 1.0601 & 1.0604\
110019.IB & 6.97 & 3.93 & 2 & 1.0577 & 1.0580\
110021.IB & 4.12 & 3.65 & 1 & 1.0246 & 1.0248\
120005.IB & 4.52 & 3.41 & 1 & 1.0169 & 1.0169\
120010.IB & 4.77 & 3.14 & 1 & 1.0060 & 1.0060\
130003.IB & 5.40 & 3.42 & 1 & 1.0203 & 1.0205\
130008.IB & 5.63 & 3.29 & 1 & 1.0146 & 1.0147\
130015.IB & 5.86 & 3.46 & 1 & 1.0242 & 1.0243\
130020.IB & 6.13 & 4.07 & 1 & 1.0587 & 1.0590\
130023.IB & 4.19 & 4.13 & 1 & 1.0436 & 1.0437\

转换因子的精确度
================

在前面已经提及过转换因子的精确度问题，即精确的转换因子应当是计算到应计利息日，即提出交割日后的第二个交易日，因此对于一个可交割券来说，应当从交割月份的 3 个交易日到最后交易日的第 2 个交易日止，分别计算转换因子。

<span>@lrrrrr</span>\
债券代码 & 剩余期限 & 票面 & 付息频率 & 贴现日 & CF（精确）\
\
债券代码 & 剩余期限 & 票面 & 付息频率 & 贴现日 & CF（精确）\
 130020.IB & 6.62 & 4.07 & 1 & 2014-03-05 & 1.0632\
130020.IB & 6.62 & 4.07 & 1 & 2014-03-06 & 1.0632\
130020.IB & 6.62 & 4.07 & 1 & 2014-03-07 & 1.0632\
130020.IB & 6.61 & 4.07 & 1 & 2014-03-10 & 1.0631\
130020.IB & 6.61 & 4.07 & 1 & 2014-03-11 & 1.0631\
130020.IB & 6.61 & 4.07 & 1 & 2014-03-12 & 1.0631\
130020.IB & 6.60 & 4.07 & 1 & 2014-03-13 & 1.0630\
130020.IB & 6.60 & 4.07 & 1 & 2014-03-14 & 1.0630\
130020.IB & 6.59 & 4.07 & 1 & 2014-03-17 & 1.0630\
130020.IB & 6.59 & 4.07 & 1 & 2014-03-18 & 1.0629\

[^1]: 实际可用于交割的券种要按照《中国金融期货交易所 5 年期国债期货合约交割细则》（简称《交割细则》）中规定来确定，目前各合约分别有大概不到 30 只国债可用于交割。

[^2]: 此处关于天数的计算规则和方法在后面 [sec: factors] 小节中探讨。

[^3]: 这里提到的精确也只是相对精确的概念，即精确到天相较于精确到月更为精确，更进一步的探讨在 [sec:
    precision] 小节。

[^4]: 具体可以查看中金所网站公布的《关于发布5年期国债期货转换因子和应计利息计算公式的通知》。

[^5]: 关于可交割券的付息日能否出现在合约到期月份的分析结论是——可能性存在但概率很低，原因在于，财政部规定国债付息日前 10 个工作日暂停转托管，付息日后第一个工作恢复，而一个月的工作日一般最多跨五周，最后交易日为第二个周五，且前两周内均可交割，而最后交易日后仍需要三个交易日完成缴款过券，因此付息日前推 10 个工作日在第三周周三及以前的均不可以成为可交割券：因此，需满足这样的条件才有可能，即交割月首日不能为周一（当月为 31 天）或周二（当月为 30 天），同时是在最后一周的周三发行、周四起息的新发记账式国债。还要注意的是，财政部的国债发行在合约到期的季末月份最后一周通常会取消发行，2013 年的 3、6、9 和 12 月的最后一周均没有国债发行，但 2012 年存在个别债券满足以上条件，但还要等到其以后期限进入 4 至 7 年时视期货合约到期月份而定能否成为可交割券，由于月份的日期分布差异较大，真正满足所有条件的概率应当会非常低。

[^6]: 这是由于我们将贴现日根据中金所的规定设定在了合约到期月的首日，因此导致精确到天的剩余期限大于等于精确到月。

[^7]: 主要指美国，我国的国债期货合约设计理念基本来自于美国，但卖方在合约到期月可强行平仓的典型美式期权设计却没有引入，必须买卖双方同时举牌才能配对成交。

[^8]: 根据中金所的规定，申请交割和最后一个交易日后的集中交割都是在交易日后的第二个交易日为配对缴款日，而申请交割是从该月的首个交易日开始。

[^9]: 本节只对函数中的关键点进行讨论，函数的代码及注释在附录中列出。

[^10]: 本文的函数中提供了输出结果的选项，可以为完整的数据框，也可以各种简化版本的函数

[^11]: 前面已经提到过，目前可交割券的付息频率（`freq`）有两种，如果为每年付息一次则步进为 1 年，如果为每年付息两次则为 6 个月；还应当指出的是这种间隔是自然间隔，即具体日期为经过间隔后的那个月份对应的日期，而不是指定年或月份为某个具体天数。

[^12]: 中金所应于合约首个交易日的前一交易日公告可交割券及转换因子，对于 TF1409 而言应为 2013 年 12 月 13 日。
